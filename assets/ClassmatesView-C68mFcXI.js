import{a as ee}from"./index-BfJ1v8kG.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as se}from"./elementPlus-CHQYLhPp.js";import{r as f,c as h,h as le,z as y,B as s,R as e,J as t,al as o,A as _,Q as A,a6 as D,I as p,P as n,L as m,O as d,E as ae}from"./vendor-Kw1AtJDw.js";import"./index-D5g6VmwX.js";const oe={class:"classmates-view"},ne={class:"header-actions"},ce={class:"search-and-filter"},de={class:"stat-content"},ie={class:"stat-icon"},_e={class:"stat-info"},re={class:"stat-number"},ue={class:"stat-content"},me={class:"stat-icon male"},ve={class:"stat-info"},pe={class:"stat-number"},fe={class:"stat-content"},he={class:"stat-icon female"},ye={class:"stat-info"},be={class:"stat-number"},we={class:"stat-content"},ge={class:"stat-icon"},Ce={class:"stat-info"},Ve={class:"stat-number"},ke={class:"classmates-grid"},Se=["onClick"],qe={class:"student-avatar"},xe={class:"student-info"},ze={class:"student-name"},Be={class:"student-id"},Le={class:"student-dormitory"},Me={class:"student-tags"},Qe={class:"contact-icons"},Ue={key:0,class:"empty-state"},Ae={key:0,class:"student-detail"},De={class:"detail-avatar"},Ee={class:"detail-info"},Ne={__name:"ClassmatesView",setup(Fe){const w=f(""),g=f(""),k=f(!1),c=f(null),C=f([]),z=f(!1),B=h(()=>{let i=C.value;if(w.value){const l=w.value.toLowerCase();i=i.filter(v=>v.full_name.toLowerCase().includes(l)||v.student_id&&v.student_id.toLowerCase().includes(l)||v.dormitory&&v.dormitory.toLowerCase().includes(l))}return g.value&&(i=i.filter(l=>l.dormitory===g.value)),i}),S=h(()=>C.value.length),L=h(()=>Math.floor(S.value*.6)),E=h(()=>S.value-L.value),N=h(()=>M.value.length),M=h(()=>[...new Set(C.value.map(l=>l.dormitory).filter(Boolean))].sort()),F=i=>{c.value=i,k.value=!0},P=async()=>{z.value=!0;try{const i=await ee.users.getAll();C.value=i.data.map(l=>({...l,is_online:Math.random()>.5}))}catch(i){console.error("加载学生数据失败:",i),se.error("加载学生数据失败")}finally{z.value=!1}};return le(()=>{P()}),(i,l)=>{var U;const v=o("Search"),u=o("el-icon"),R=o("el-input"),H=o("el-option"),I=o("el-select"),J=o("User"),b=o("el-card"),V=o("el-col"),O=o("Male"),T=o("Female"),$=o("House"),j=o("el-row"),Q=o("el-avatar"),q=o("el-tag"),G=o("ChatRound"),x=o("el-tooltip"),K=o("ChatSquare"),W=o("Phone"),X=o("el-empty"),r=o("el-descriptions-item"),Y=o("el-descriptions"),Z=o("el-dialog");return _(),y("div",oe,[s("div",ne,[l[3]||(l[3]=s("h2",{class:"page-title"},"班级同学",-1)),s("div",ce,[e(R,{modelValue:w.value,"onUpdate:modelValue":l[0]||(l[0]=a=>w.value=a),placeholder:"搜索同学姓名、学号或宿舍...",style:{width:"300px"},clearable:""},{prefix:t(()=>[e(u,null,{default:t(()=>[e(v)]),_:1})]),_:1},8,["modelValue"]),e(I,{modelValue:g.value,"onUpdate:modelValue":l[1]||(l[1]=a=>g.value=a),placeholder:"筛选宿舍",clearable:"",style:{width:"150px"}},{default:t(()=>[(_(!0),y(A,null,D(M.value,a=>(_(),p(H,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),e(j,{gutter:20,class:"stats-cards"},{default:t(()=>[e(V,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",de,[s("div",ie,[e(u,null,{default:t(()=>[e(J)]),_:1})]),s("div",_e,[s("div",re,n(S.value),1),l[4]||(l[4]=s("div",{class:"stat-label"},"总人数",-1))])])]),_:1})]),_:1}),e(V,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",ue,[s("div",me,[e(u,null,{default:t(()=>[e(O)]),_:1})]),s("div",ve,[s("div",pe,n(L.value),1),l[5]||(l[5]=s("div",{class:"stat-label"},"男生",-1))])])]),_:1})]),_:1}),e(V,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",fe,[s("div",he,[e(u,null,{default:t(()=>[e(T)]),_:1})]),s("div",ye,[s("div",be,n(E.value),1),l[6]||(l[6]=s("div",{class:"stat-label"},"女生",-1))])])]),_:1})]),_:1}),e(V,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",we,[s("div",ge,[e(u,null,{default:t(()=>[e($)]),_:1})]),s("div",Ce,[s("div",Ve,n(N.value),1),l[7]||(l[7]=s("div",{class:"stat-label"},"宿舍数",-1))])])]),_:1})]),_:1})]),_:1}),e(b,{class:"classmates-card"},{default:t(()=>[s("div",ke,[(_(!0),y(A,null,D(B.value,a=>(_(),y("div",{key:a.id,class:"student-card",onClick:Pe=>F(a)},[s("div",qe,[e(Q,{size:60,src:a.avatar_url,class:"avatar"},{default:t(()=>[d(n(a.full_name.charAt(0)),1)]),_:2},1032,["src"]),s("div",{class:ae(["online-status",{online:a.is_online}])},null,2)]),s("div",xe,[s("h3",ze,n(a.full_name),1),s("p",Be,"学号："+n(a.student_id||"未填写"),1),s("p",Le,"宿舍："+n(a.dormitory||"未填写"),1),s("div",Me,[a.role==="admin"?(_(),p(q,{key:0,type:"danger",size:"small"},{default:t(()=>[...l[8]||(l[8]=[d("管理员",-1)])]),_:1})):m("",!0),a.role==="teacher"?(_(),p(q,{key:1,type:"warning",size:"small"},{default:t(()=>[...l[9]||(l[9]=[d("老师",-1)])]),_:1})):m("",!0),a.hometown?(_(),p(q,{key:2,size:"small"},{default:t(()=>[d(n(a.hometown),1)]),_:2},1024)):m("",!0)]),s("div",Qe,[a.qq?(_(),p(x,{key:0,content:"QQ",placement:"top"},{default:t(()=>[e(u,{class:"contact-icon qq"},{default:t(()=>[e(G)]),_:1})]),_:1})):m("",!0),a.wechat?(_(),p(x,{key:1,content:"微信",placement:"top"},{default:t(()=>[e(u,{class:"contact-icon wechat"},{default:t(()=>[e(K)]),_:1})]),_:1})):m("",!0),a.phone?(_(),p(x,{key:2,content:"手机",placement:"top"},{default:t(()=>[e(u,{class:"contact-icon phone"},{default:t(()=>[e(W)]),_:1})]),_:1})):m("",!0)])])],8,Se))),128))]),B.value.length===0?(_(),y("div",Ue,[e(X,{description:"没有找到匹配的同学"})])):m("",!0)]),_:1}),e(Z,{modelValue:k.value,"onUpdate:modelValue":l[2]||(l[2]=a=>k.value=a),title:((U=c.value)==null?void 0:U.full_name)+" 的详细信息",width:"500px","destroy-on-close":""},{default:t(()=>[c.value?(_(),y("div",Ae,[s("div",De,[e(Q,{size:80,src:c.value.avatar_url},{default:t(()=>[d(n(c.value.full_name.charAt(0)),1)]),_:1},8,["src"])]),s("div",Ee,[e(Y,{column:1,border:""},{default:t(()=>[e(r,{label:"姓名"},{default:t(()=>[d(n(c.value.full_name),1)]),_:1}),e(r,{label:"学号"},{default:t(()=>[d(n(c.value.student_id||"未填写"),1)]),_:1}),e(r,{label:"邮箱"},{default:t(()=>[d(n(c.value.email),1)]),_:1}),e(r,{label:"手机"},{default:t(()=>[d(n(c.value.phone||"未填写"),1)]),_:1}),e(r,{label:"QQ"},{default:t(()=>[d(n(c.value.qq||"未填写"),1)]),_:1}),e(r,{label:"微信"},{default:t(()=>[d(n(c.value.wechat||"未填写"),1)]),_:1}),e(r,{label:"宿舍"},{default:t(()=>[d(n(c.value.dormitory||"未填写"),1)]),_:1}),e(r,{label:"家乡"},{default:t(()=>[d(n(c.value.hometown||"未填写"),1)]),_:1}),e(r,{label:"个人简介"},{default:t(()=>[d(n(c.value.bio||"这个人很懒，什么都没留下..."),1)]),_:1})]),_:1})])])):m("",!0)]),_:1},8,["modelValue","title"])])}}},Te=te(Ne,[["__scopeId","data-v-08c53283"]]);export{Te as default};
